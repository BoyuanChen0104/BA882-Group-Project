import os
import json
import datetime
from dateutil.parser import isoparse  # For robust date parsing
from dateutil import tz  # For timezone handling
from prefect import task, flow, get_run_logger
from apify_client import ApifyClient
from google.cloud import storage

# Retrieve environment variables
APIFY_API_TOKEN = os.getenv("APIFY_API_TOKEN")
GCS_BUCKET_NAME = os.getenv("GCS_BUCKET_NAME")

@task
def fetch_all_reviews_before(end_date_str):
    logger = get_run_logger()
    client = ApifyClient(APIFY_API_TOKEN)
    
    # Convert end_date_str to datetime object with timezone info
    end_date = isoparse(end_date_str + 'T00:00:00Z')
    reviews_start_date = "2022-01-01"
    
    # Define your start URLs
    start_urls = [
        {"url": "https://www.google.com/maps/place/Atlantic+Fish+Company/@42.3555503,-71.1638682,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37a0ef45076f1:0x62c7217ed7b7c8fb!8m2!3d42.3493054!4d-71.0812108!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tdrgcm6?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Boston+Sail+Loft/@42.3624738,-71.1226418,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e3708836c43e2b:0x28f50a9a2cba0af8!8m2!3d42.3624738!4d-71.050544!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1vcjn7z7?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Row+34/@42.3624738,-71.1226418,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37a80312391f7:0xb8f874bb24bfb41e!8m2!3d42.3495517!4d-71.0476206!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1yhbl8zyv?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Saltie+Girl/@42.3511566,-71.1496657,13z/data=!3m1!5s0x89e37a0b8bfb887f:0x78244bc3f30f3add!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37a0b8bf59d5f:0x19ad3773a84b9f68!8m2!3d42.3511566!4d-71.0775679!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11bxj8dlzz?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Pearl/@42.3511566,-71.1496657,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37b8dcf5a92f3:0x7cc06bce40d0496!8m2!3d42.3250821!4d-71.0622817!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11pwt0_ry2?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Banks+Seafood+and+Steak/@42.3511566,-71.1496657,13z/data=!3m1!5s0x89e37a0cd241eb63:0x48020d80c3aefdf0!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37b7669a73983:0x9dd79ee8fa0aa851!8m2!3d42.3488564!4d-71.0740315!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11rgzymfw9?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Summer+Shack/@42.3511566,-71.1496657,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37a1aa9031435:0x856b6c5edecec8a2!8m2!3d42.3471055!4d-71.0855221!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11bbrjz_lx?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Barking+Crab/@42.3536651,-71.1208549,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e3707e3a26fbdb:0x28cc6d13871fcf33!8m2!3d42.3536651!4d-71.0487571!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARRjcmFiX2Rpc2hfcmVzdGF1cmFudJoBJENoZERTVWhOTUc5blMwVkpRMEZuU1VOeGNWODJWV2gzUlJBQuABAA!16s%2Fm%2F01_hd60?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/B%26G+Oysters/@42.3439161,-71.1433937,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37a6d7284219d:0x67c18b5545f3ad78!8m2!3d42.3439161!4d-71.0712959!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARVveXN0ZXJfYmFyX3Jlc3RhdXJhbnTgAQA!16s%2Fm%2F0xmdg_g?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Rowes+Wharf+Sea+Grille/@42.3562236,-71.1223532,13z/data=!3m1!5s0x89e3707e8d7196ff:0xedaa3deb29992903!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e370875bdec323:0xac3b6a606682ac7b!8m2!3d42.3562236!4d-71.0502554!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSAQpyZXN0YXVyYW504AEA!16s%2Fg%2F1hc2mcc_w?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/James+Hook+%26+Co/@42.3562236,-71.1223532,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e3707e40e4f63b:0xc0e6695e6179ea71!8m2!3d42.3549505!4d-71.0509842!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tdcsjvx?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Select+Oyster+Bar/@42.3485887,-71.1562061,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37a0f95a1549b:0xb1c0b98204eb6d11!8m2!3d42.3485887!4d-71.0841083!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11b6ghmbwx?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Union+Oyster+House/@42.361288,-71.1290058,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37085f3085631:0x57b1c27214abd128!8m2!3d42.361288!4d-71.056908!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16zL20vMDhfdmts?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Boiling+Crab/@42.3722477,-71.1932989,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e377c0ee60c4e5:0xdf4ef32b3ce2b7b6!8m2!3d42.3722477!4d-71.1212011!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11nxyw3k34?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Neptune+Oyster/@42.363239,-71.1280658,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e3708f2de4ee09:0x3bf3e0fd562f98e7!8m2!3d42.363239!4d-71.055968!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1th5dkzp?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Ostra/@42.3511397,-71.1392956,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e3709e5e8a9c9f:0x3c727aa454375ea7!8m2!3d42.3511397!4d-71.0671978!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1ptx22bdn?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Fin+Point+Oyster+Bar+%2B+Grille/@42.3511397,-71.1392956,13z/data=!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37086e094deb1:0x4d8d2bc5464b700b!8m2!3d42.3574252!4d-71.0530233!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARVveXN0ZXJfYmFyX3Jlc3RhdXJhbnSaASNDaFpEU1VoTk1HOW5TMFZKUTBGblNVUjRlVnBZWlVaUkVBReABAA!16s%2Fg%2F11c2pcdj70?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Salty+Dog+Seafood+Grille+%26+Bar/@42.3601072,-71.1276136,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37085d9d7b96f:0xee870106d4e66cd6!8m2!3d42.3601072!4d-71.0555158!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBDWJhcl9hbmRfZ3JpbGzgAQA!16s%2Fg%2F1trvmfqz?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Mare+Oyster+Bar/@42.3511397,-71.1392956,13z/data=!3m1!5s0x89e37088cbe6e667:0x226545a97be71ec6!4m12!1m2!2m1!1sboston+seafood+restaurant!3m8!1s0x89e37088e73c0745:0xf1d8b4591e044616!8m2!3d42.3628428!4d-71.0551879!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tgdv468?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Daily+Catch+Waterfront/@42.3628703,-71.123364,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3712af27c6b8d:0x4b14cfe94d74d016!8m2!3d42.3628703!4d-71.0512662!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WhsiGWJvc3RvbiBzZWFmb29kIHJlc3RhdXJhbnSSARJzZWFmb29kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11jw5g1rd9?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Mo%C3%ABca/@42.3818623,-71.1922199,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3774a755236ed:0x7013caa4eb49f51c!8m2!3d42.3818623!4d-71.1201221!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11smjk_qhd?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Seamark+Seafood+%26+Cocktails/@42.3949841,-71.1420752,13z/data=!3m1!5s0x89e3711ee5e8b0b3:0x5473d59764648427!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3718fef9f13b5:0x6349b3cb9dae18d6!8m2!3d42.3949841!4d-71.0699774!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBCnJlc3RhdXJhbnTgAQA!16s%2Fg%2F11y2hwmd6v?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Belle+Isle+Seafood/@42.382247,-71.0657048,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e36e2c6eb00e5b:0xf60f010b7f62377d!8m2!3d42.382247!4d-70.993607!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F12hznrp51?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Red's+Best+Fish+Market/@42.3622373,-71.1297775,13z/data=!3m1!5s0x89e3708f64f462d3:0x72ed99a21702b4cb!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3708f5c43a885:0x926b157c3577718e!8m2!3d42.3622373!4d-71.0576797!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBDnNlYWZvb2RfbWFya2V04AEA!16s%2Fg%2F11fx8zm7ml?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Shaking+Crab+(Boston+Common)/@42.3622373,-71.1297775,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a766a6b01c7:0x83c7934cd00a798!8m2!3d42.3522881!4d-71.066189!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11f_10sl39?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Holly+Crab+Mad+For+Chicken/@42.3127714,-71.1859097,13z/data=!3m1!5s0x89e379c3009460fb:0x94435df5dde73f79!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e379c3071f9981:0x39cdb2f8e64cb45a!8m2!3d42.3518444!4d-71.1243222!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEGNhanVuX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11bxfz_m7b?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Harborside/@42.3486426,-71.1098087,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a82a704f083:0x401df052ed7a6fa2!8m2!3d42.3486426!4d-71.0377109!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tdxlwyf?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/LITTLE+WHALE+OYSTER+BAR/@42.3485744,-71.1574207,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37b31b5bb8793:0x3b1e28f3912b6432!8m2!3d42.3485744!4d-71.0853229!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11j1xrt7s6?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Rabia's+Dolce+Fumo/@42.3601072,-71.1276136,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3708f2cb065f5:0xe162920666021cb1!8m2!3d42.363435!4d-71.055762!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tp0fp4k?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Ocean+Prime/@42.3601072,-71.1276136,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a827ec1438b:0x963fdfc6ed1ffaf3!8m2!3d42.3513454!4d-71.0434783!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11ckthhy1k?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Oceanaire+Seafood+Room/@42.3601072,-71.1276136,13z/data=!3m1!5s0x89e370843f086827:0x66e3d58cd06f9639!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37084fadf1153:0xde572406a4b4026f!8m2!3d42.3590723!4d-71.059182!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBFmZpbmVfZGluaW5nX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tjfhvz_?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Daily+Catch+North+End/@42.3601072,-71.1276136,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37089173e9b87:0xa5a2e6bee05ed354!8m2!3d42.3640869!4d-71.0539215!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tf3pxp_?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Luke's+Lobster+Back+Bay/@42.3488572,-71.1513243,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a0dd4b22005:0x1d298662a3c2c1b2!8m2!3d42.3488572!4d-71.0792265!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11bv33gfgk?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Courthouse+Seafood/@42.3488572,-71.1513243,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e370b9f03164fd:0x5c3d48726ec0b94a!8m2!3d42.3715314!4d-71.0846084!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tdk1lw6?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Pier+6/@42.3628703,-71.123364,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e370f58c6928d5:0xf3b0dd835b82d40d!8m2!3d42.3731806!4d-71.0501127!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1ydpvch4t?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Wicked+Lobsta/@42.3628703,-71.123364,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371663310cf85:0x533f00a7af34ec37!8m2!3d42.360206!4d-71.0548996!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11jm1jgp56?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Copley+Place/@42.347148,-71.1504736,13z/data=!3m1!5s0x89e37a0d93723ac1:0x7edf0a3a377467b4!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a0de7e77a4b:0xa8c6cce1c681137c!8m2!3d42.347148!4d-71.0783758!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1w0sdwns?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url":  "https://www.google.com/maps/place/Bootleg+Special/@42.347148,-71.1504736,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a73d2155555:0xac225fe2f92d1ed6!8m2!3d42.3473333!4d-71.0684287!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11hccvmbfd?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Shaking+Crab+(Newton)/@42.358018,-71.2721238,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e382a272797ebd:0xff6c2a969ddb35c9!8m2!3d42.358018!4d-71.200026!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11clhshl0b?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Summer+Shack/@42.3937391,-71.2132824,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37706236c9855:0x41687ba9cc98808b!8m2!3d42.3937391!4d-71.1411846!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fm%2F0zsrmyb?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Luke's+Lobster+Downtown+Crossing/@42.3573656,-71.1302826,13z/data=!3m1!5s0x89e378fd428e4ae7:0xdda7689c3d57a695!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e370847bd193ad:0xdc67fdab3ff4106f!8m2!3d42.3573656!4d-71.0581848!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11c564ctwy?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Chart+House/@42.3573656,-71.1302826,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3707d541f0ce9:0xc65e36f95e42bc28!8m2!3d42.3601688!4d-71.0495078!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tgcn91c?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Limani+Grille+Seaport/@42.3525231,-71.1156951,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371ad24f192e5:0x3050c285b3af8a03!8m2!3d42.3525231!4d-71.0435973!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11t_wbggt1?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Gaga+Seafood+Restaurant/@42.3507257,-71.1330291,13z/data=!3m1!5s0x89e37a782e81a907:0x9b3b2e1cc26e824c!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a7831f98a4b:0xf58739582b565c2c!8m2!3d42.3507257!4d-71.0609313!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tcyggt1?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Daily+Catch+Brookline/@42.34619,-71.1998426,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e379c74627c3e7:0x3ff241cd305087d1!8m2!3d42.34619!4d-71.1277448!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEml0YWxpYW5fcmVzdGF1cmFudOABAA!16s%2Fg%2F1tf08p23?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Victoria+Seafood/@42.34619,-71.1998426,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e379c29a315511:0x4d073e1da162b594!8m2!3d42.35217!4d-71.121709!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEmNoaW5lc2VfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tk_kqqg?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Eddie+V's+Prime+Seafood/@42.3460623,-71.1549406,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37b9871816caf:0x370645981c6274ff!8m2!3d42.3460623!4d-71.0828428!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11h2xzv9n_?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Boston+%26+Maine+Fish+Co/@42.3601224,-71.127507,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37085d9d7b96f:0xb894cdeac6ef0c61!8m2!3d42.3601224!4d-71.0554092!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tgs1yqb?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Hourly+Oyster+House/@42.3729149,-71.1911703,13z/data=!3m1!5s0x89e37742c5c040d7:0xa0f4b697e976b693!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37742c5af1e47:0x50da24f9980b8828!8m2!3d42.3729149!4d-71.1190725!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11c56hcxn8?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Cusser's+Roast+Beef+%26+Seafood/@42.3443482,-71.1747219,13z/data=!3m1!5s0x89e379f503b692c1:0x1dac24f72d6d5fe5!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3795faf8109c1:0xdafdeca518dcdad2!8m2!3d42.3443482!4d-71.1026241!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11jszdrpff?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Downtown+Crossing/@42.3536739,-71.1342016,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3709d4967e2d3:0x4676a95c9265ec01!8m2!3d42.3536739!4d-71.0621038!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1pzrb76gk?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Oyster+Bar/@42.3602117,-71.1265759,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3712741045c15:0x865117fa02c875c2!8m2!3d42.3602117!4d-71.0544781!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11l6skf24q?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Jumbo+Seafood/@42.3602117,-71.1265759,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a7847ac82ad:0x59ee82a6474ad485!8m2!3d42.350931!4d-71.0601999!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEmNoaW5lc2VfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tjt2z0n?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Harborside+Grill+and+Patio/@42.3591039,-71.0994551,13z/data=!3m1!5s0x89e3706cd757980b:0xb22ccd0f54656e8c!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e370118a21bc3b:0x5087ef31d300594c!8m2!3d42.3591039!4d-71.0273573!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tx8v6k4?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Waypoint/@42.3695286,-71.1844,13z/data=!3m1!5s0x89e3775b1dba5179:0xb30cb5470758ec12!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3775b1da52211:0xff227970e629b19c!8m2!3d42.3695286!4d-71.1123022!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11cr_377d0?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Long+Wharf/@42.3594517,-71.1231618,13z/data=!3m1!5s0x89e37087eb49848b:0x7d625acc96e5bb1d!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37087bf50b88d:0x1ab6b4c662b99d78!8m2!3d42.3594517!4d-71.051064!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tdmr1m0?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Boston+Chowda+Co/@42.3594517,-71.1231618,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37085d9d7b96f:0x8f49e25703332b59!8m2!3d42.3601465!4d-71.0550464!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBFm5ld19lbmdsYW5kX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tdkypqr?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Hook+%2B+Line/@42.3594517,-71.1231618,13z/data=!3m1!5s0x89e3707ec174691f:0x47c08dbbfb51a95c!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3714570c860f3:0x319548ead31e2060!8m2!3d42.3538039!4d-71.0450294!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11l683gb5b?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Red+House+Restaurant/@42.3724293,-71.1933187,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37767ff73e565:0x457358896ca68593!8m2!3d42.3724293!4d-71.1212209!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tf7t46j?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Aqua+Pazza/@42.3632151,-71.1261944,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37088e0e83d0d:0xc0f5e797145cd511!8m2!3d42.3632151!4d-71.0540966!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11bwhbfp31?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Lobstah+On+A+Roll/@42.3416853,-71.1528291,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a16b438e3f3:0x427727df885af175!8m2!3d42.3416853!4d-71.0807313!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11f_f6c536?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Puritan+Oyster+Bar/@42.3729623,-71.1689807,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371403a765767:0xa066b6bc4ba1a8b6!8m2!3d42.3729623!4d-71.0968829!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBFW95c3Rlcl9iYXJfcmVzdGF1cmFudJoBI0NoWkRTVWhOTUc5blMwVkpRMEZuU1VSb2NEWnlYMkpSRUFF4AEA!16s%2Fg%2F11shgdx04v?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Chestnut+Hill/@42.3226742,-71.2421526,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37892b67f40f3:0x7c9af61cf1f048d!8m2!3d42.3226742!4d-71.1700548!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1wrgl544?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Drydock+Cafe/@42.3444139,-71.1082366,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a9c998a2031:0x3a3984e8200c776f!8m2!3d42.3444139!4d-71.0361388!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11dxs3wmr_?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Royal+Roast+Beef+and+Seafood/@42.3855707,-71.082938,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371d3b42b8ba1:0xb734838b9dcbdb9a!8m2!3d42.3855707!4d-71.0108402!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tf9zf8s?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Walrus+%26+Carpenter+Oyster+Bar/@42.3597233,-71.1280028,13z/data=!3m1!5s0x89e37086c2765da5:0x1242ad362e5e8932!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3708615e58493:0x87438eb849cddd35!8m2!3d42.3597233!4d-71.055905!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11dyb4xyb2?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Tias+Waterfront/@42.3597233,-71.1280028,13z/data=!3m1!5s0x89e37087e6365a7f:0x4b434abff714d104!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37087c4f2f021:0x6dadce19869e16f!8m2!3d42.360265!4d-71.0517835!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBDWJhcl9hbmRfZ3JpbGyaASNDaFpEU1VoTk1HOW5TMFZKUTBGblNVUnlORFI1VFV0bkVBReABAA!16s%2Fg%2F1tcvvw8h?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Park+Square/@42.3516364,-71.1421968,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a7427d0a7ab:0xeccc1359f6674b31!8m2!3d42.3516364!4d-71.070099!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tgz6h6j?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/New+Golden+Gate+Seafood/@42.3516364,-71.1421968,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37b5a14c077b7:0x518d09e943cf68a7!8m2!3d42.35133!4d-71.0600293!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBD3JpY2VfcmVzdGF1cmFudOABAA!16s%2Fg%2F11qn477vt5?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Kendall+Square/@42.3628136,-71.1595613,13z/data=!3m1!5s0x89e370af252450ab:0xfc624b1cff57e362!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37164e07536df:0x43175a5e84dc8e7f!8m2!3d42.3628136!4d-71.0874635!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11k19tfstk?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Citizen+Public+House+%26+Oyster+Bar/@42.3442392,-71.1701276,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e379f5fc7c5a4f:0x3a608fcad04c37f3!8m2!3d42.3442392!4d-71.0980298!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBCnJlc3RhdXJhbnTgAQA!16s%2Fg%2F1tdb0q2w?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Lobstah+On+A+Roll/@42.349281,-71.1548144,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37b3f9522ca35:0x7614de5460407fc9!8m2!3d42.349281!4d-71.0827166!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11fnqw2tlr?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Pauli's/@42.3633174,-71.128075,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3708f2db96663:0x4dca64fac7341067!8m2!3d42.3633174!4d-71.0559772!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBDXNhbmR3aWNoX3Nob3DgAQA!16s%2Fg%2F1hc2q8ghv?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/STK+Steakhouse/@42.350665,-71.1453688,13z/data=!3m1!5s0x89e37a74ad87fe8d:0x448e55ca124afa9c!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37bc7e103e569:0x902cc666ef8326b!8m2!3d42.350665!4d-71.073271!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fg%2F11l66n1p3x?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Logan+Airport+Terminal+B/@42.363409,-71.0978138,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371fe36d7e995:0x485eb8b7976c2c27!8m2!3d42.363409!4d-71.025716!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11pv3sk3x5?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Eddie+Merlot's/@42.3481313,-71.1133218,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a825e9aaaab:0x4a7db3d5288a19d1!8m2!3d42.3481313!4d-71.041224!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fg%2F11lm3lqgf4?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Harvest/@42.3736799,-71.1939719,13z/data=!3m1!5s0x89e3776819a8285d:0x6412c6d88125eb93!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e377682248a4c9:0x58878d97d4c27a5c!8m2!3d42.3736799!4d-71.1218741!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBE2FtZXJpY2FuX3Jlc3RhdXJhbnTgAQA!16s%2Fm%2F0j5kjxk?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Sullivan's+Castle+Island/@42.3388757,-71.0852639,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37aaf5d5ccadd:0x9b07f3674b05d5d4!8m2!3d42.3388757!4d-71.0131661!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBCnJlc3RhdXJhbnTgAQA!16s%2Fg%2F1tj9c_xp?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Fisherman's+Net/@42.360229,-71.1263429,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37085d9d7b96f:0x8b4990131e65ffed!8m2!3d42.360229!4d-71.0542451!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1tf0rmk7?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/PURO+ceviche+bar/@42.3492059,-71.1552238,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a0fa8bec35d:0x1c2db5bf2fa86d51!8m2!3d42.3492059!4d-71.083126!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11g886y24k?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Del+Frisco's+Double+Eagle+Steakhouse/@42.3489496,-71.1107898,13z/data=!3m1!5s0x89e37a82a9cf6167:0xdec3c1ab5eb9591c!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a829fffc22f:0x2b4efe37733d36be!8m2!3d42.3489496!4d-71.038692!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fm%2F0wpvz7g?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Joe's+Waterfront/@42.3619902,-71.1228076,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e370883c8e3eb7:0xbbcbaa98ab0c8472!8m2!3d42.3619902!4d-71.0507098!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBE2FtZXJpY2FuX3Jlc3RhdXJhbnSaASNDaFpEU1VoTk1HOW5TMFZKUTBGblNVUlBiM1p1ZGxkM0VBReABAA!16s%2Fg%2F1trqj6w_?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Dovetail+Restaurant/@42.3619902,-71.1228076,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3717dfecaaf3f:0xa140d55440bfa9ff!8m2!3d42.3752289!4d-71.0547386!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBE2FtZXJpY2FuX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11mvpds9f7?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Judy's+Bay/@42.3682879,-71.1698805,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3771d68dcebc3:0x35b112c190629303!8m2!3d42.3682879!4d-71.0977827!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBE2phcGFuZXNlX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11rjkt7l3s?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Abe+%26+Louie's/@42.349138,-71.1536048,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a0ef7c51c4d:0x3b643d1ee9cd8345!8m2!3d42.349138!4d-71.081507!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fg%2F1tl1pg4w?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Capital+Grille/@42.349138,-71.1536048,13z/data=!3m1!5s0x89e37a0fe0de1597:0x97cbb37fa71416e0!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a052e4ebae7:0xd9005f3e6d853cec!8m2!3d42.347725!4d-71.085255!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBFmZpbmVfZGluaW5nX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tgxvkgx?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Logan+Airport+Terminal+A/@42.3648937,-71.0943747,13z/data=!3m1!5s0x89e3703e207f1c79:0xde9e23e36e2c13d7!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37014d5da4937:0xa1ed1baf265d7e6d!8m2!3d42.3648937!4d-71.0222769!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1hc2n4dtp?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Red's+Best+Boston+Logan/@42.3648937,-71.0943747,13z/data=!3m1!5s0x89e3703ce3392b69:0x49afba5b5c57afa3!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371d28318910b:0x51382809c394d15a!8m2!3d42.3666337!4d-71.0164437!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11stvn8k2t?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Mooo....+Seaport/@42.349393,-71.12229,13z/data=!3m1!5s0x89e3708185ecfd69:0x98fefce54d84fe26!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37b3e416ad8c1:0x859d5ce7a22e9c7d!8m2!3d42.349393!4d-71.0501922!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fg%2F11nwbcpfdf?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/The+Capital+Grille/@42.319232,-71.2498928,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37899cf433e73:0x5f99b2de8dfc73c9!8m2!3d42.319232!4d-71.177795!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBFmZpbmVfZGluaW5nX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F1tk4s4vq?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Cusser's+Roast+Beef+%26+Seafood/@42.3647933,-71.1345985,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37112e91361e3:0xd1c12c18a593bc16!8m2!3d42.3647933!4d-71.0625007!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBE2FtZXJpY2FuX3Jlc3RhdXJhbnTgAQA!16s%2Fg%2F11sgvhk5gd?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Del+Frisco's+Double+Eagle+Steakhouse/@42.3482359,-71.1549124,13z/data=!3m1!5s0x89e37a0fe0de1597:0x97cbb37fa71416e0!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37b7b693cbf89:0x20e1faf145e24fa3!8m2!3d42.3482359!4d-71.0828146!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fg%2F11ghtn45b8?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Morton's+The+Steakhouse/@42.3508353,-71.1105256,13z/data=!3m1!5s0x89e37a79d6ff2225:0xf4c2dd98ff1826ba!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a827c3e7635:0xa1e7f26f79a2f092!8m2!3d42.3489645!4d-71.0407695!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBCnJlc3RhdXJhbnSaASRDaGREU1VoTk1HOW5TMFZKUTBGblNVTTVlVTVYWW5WQlJSQULgAQA!16s%2Fg%2F1th883wm?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Grill+23+%26+Bar/@42.3494604,-71.1440598,13z/data=!3m1!5s0x89e37a7364b434e5:0x2629f85b2c41e7a4!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37a73679ce22d:0x451ce72f4d82cd7c!8m2!3d42.3494604!4d-71.071962!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBC3N0ZWFrX2hvdXNl4AEA!16s%2Fg%2F1td54fpy?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Logan+Airport+Terminal+E+-+Gate+13/@42.3698318,-71.0958797,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3710005323ead:0x6974261d47d3cb68!8m2!3d42.3698318!4d-71.0237819!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11y3y_6g2p?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Granary+Tavern/@42.358783,-71.1246288,13z/data=!3m1!5s0x89e30c98ec313ab9:0x502f2d8841a6dc85!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e37087aab1a2f9:0xf8fe9b529c9ca262!8m2!3d42.358783!4d-71.052531!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBCWdhc3Ryb3B1YuABAA!16s%2Fg%2F11h12dwnv?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Giacomo's+Boston+North+End/@42.358783,-71.1246288,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e373bbc1e81529:0x3c307fcce8ef1b39!8m2!3d42.3646219!4d-71.0535032!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEml0YWxpYW5fcmVzdGF1cmFudOABAA!16s%2Fg%2F11b88s1cv7?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Boston+Lobster+Seafood+Restaurant/@34.0873389,-118.1458009,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x80c2dabdd7c92899:0xb680c9455a1c2590!8m2!3d34.0873389!4d-118.0737031!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F1q6n2mn_7?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Fish+Taco+By+Love+Art/@42.3629446,-71.127121,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371005c723593:0x6081f11940b883ac!8m2!3d42.3629446!4d-71.0550232!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBD3RhY29fcmVzdGF1cmFudJoBJENoZERTVWhOTUc5blMwVkpRMEZuU1VSRWFYUXRWWE4zUlJBQuABAA!16s%2Fg%2F11y2sx0765?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Luke's+Lobster+Seaport+-+Temporarily+Closed/@42.3629446,-71.127121,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3707ee2ecc0b5:0xcdd64fe1902eda91!8m2!3d42.352986!4d-71.046516!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11f_rc26rp?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Legal+Sea+Foods+-+Logan+Airport+Terminal+B+Connector/@42.3619538,-71.0914656,13z/data=!3m1!5s0x89e3701667b85961:0xe9dad072c95baae2!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e371610f90b849:0xdccc7e3305ed1856!8m2!3d42.3619538!4d-71.0193678!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11hzpkkvrb?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
        {"url": "https://www.google.com/maps/place/Il+Molo/@42.3653702,-71.1233718,13z/data=!4m15!1m5!2m4!1sboston+seafood+restaurant!5m1!6sgcid:seafood_restaurant!6e5!3m8!1s0x89e3708a1fca2f5f:0xf47f37c09c15eb08!8m2!3d42.3653702!4d-71.051274!9m1!1b1!15sChlib3N0b24gc2VhZm9vZCByZXN0YXVyYW50WiMiIWJvc3RvbiBzZWFmb29kIHNlYWZvb2QgcmVzdGF1cmFudJIBEnNlYWZvb2RfcmVzdGF1cmFudOABAA!16s%2Fg%2F11bz_yp4yk?entry=ttu&g_ep=EgoyMDI0MTAwMi4xIKXMDSoASAFQAw%3D%3D "},
    ]
    
    run_input = {
        "language": "en",
        "maxReviews": 2000,
        "personalData": True,
        "reviewsStartDate": reviews_start_date,
        "startUrls": start_urls
    }
    
    # Run the Apify actor
    try:
        run = client.actor("Xb8osYTtOjlsgI6k9").call(run_input=run_input)
    except Exception as e:
        logger.error(f"Failed to run Apify actor: {e}")
        raise
    
    # Retrieve data from the dataset
    try:
        all_data = list(client.dataset(run["defaultDatasetId"]).iterate_items())
        logger.info(f"Fetched {len(all_data)} reviews.")
        if all_data:
            logger.info(f"Sample data item: {all_data[0]}")
            logger.info(f"Sample data item keys: {all_data[0].keys()}")
        else:
            logger.warning("No data returned from Apify.")
    except Exception as e:
        logger.error(f"Failed to retrieve data from Apify dataset: {e}")
        raise
    
    # Filter reviews before the end_date
    filtered_data = []
    for item in all_data:
        review_date_str = item.get("publishedAtDate")
        if review_date_str:
            try:
                review_date = isoparse(review_date_str)
                if review_date <= end_date:
                    filtered_data.append(item)
            except ValueError as e:
                logger.error(f"Date parsing error for '{review_date_str}': {e}")
                continue
        else:
            logger.warning("No 'publishedAtDate' field in item.")
    
    logger.info(f"Filtered down to {len(filtered_data)} reviews before {end_date_str}.")
    return filtered_data, end_date_str

@task
def transform_data(data):
    logger = get_run_logger()
    logger.info(f"Transforming {len(data)} data items.")
    # Transform the data according to steps A to D
    transformed_data = []
    columns_to_remove = [
        'cid', 'countryCode', 'fid', 'imageUrl', 'placeId', 'publishAt',
        'reviewId', 'reviewOrigin', 'reviewUrl', 'reviewerPhotoUrl',
        'reviewerUrl', 'reviewsCount', 'searchString', 'url'
    ]
    for item in data:
        # Step A: Remove specified columns
        for col in columns_to_remove:
            item.pop(col, None)
        
        # Step B: Transform specified columns to binary
        binary_columns = ['isAdvertisement', 'isLocalGuide', 'permanentlyClosed', 'temporarilyClosed']
        for col in binary_columns:
            item[col] = int(bool(item.get(col)))
        
        # Step C: Combine 'text' and 'textTranslated' into 'reviewText'
        text = item.get('text', '')
        text_translated = item.get('textTranslated', '')
        item['reviewText'] = text_translated if text_translated else text
        # Remove the original 'text' and 'textTranslated' columns
        item.pop('text', None)
        item.pop('textTranslated', None)
        
        # Step D: Count number of images in 'reviewImageUrls'
        image_urls = item.get('reviewImageUrls', [])
        item['number_review_image'] = len(image_urls)
        # Remove 'reviewImageUrls' as per your instruction
        item.pop('reviewImageUrls', None)
        
        # Append the transformed item to the list
        transformed_data.append(item)
    
    logger.info(f"Transformed data has {len(transformed_data)} items.")
    return transformed_data

@task
def store_data_in_gcs(data, date_str):
    logger = get_run_logger()
    if not data:
        logger.warning("No data to store in GCS.")
        return
    storage_client = storage.Client()
    bucket = storage_client.bucket(GCS_BUCKET_NAME)
    
    # Define the file name in the bucket
    file_name = f"reviews_before_{date_str}.json"
    blob = bucket.blob(file_name)
    
    # Convert data to JSON string
    data_json = json.dumps(data)
    
    # Upload data to GCS
    try:
        blob.upload_from_string(data_json, content_type='application/json')
        logger.info(f"Data stored in GCS bucket '{GCS_BUCKET_NAME}' as '{file_name}'.")
    except Exception as e:
        logger.error(f"Failed to upload data to GCS: {e}")
        raise

@flow(name="Initial Data Ingestion Flow")
def initial_data_ingestion_flow(end_date_str):
    data, date_str = fetch_all_reviews_before(end_date_str)
    transformed_data = transform_data(data)
    store_data_in_gcs(transformed_data, date_str)

if __name__ == "__main__":
    # Set the end date for initial data ingestion
    END_DATE_STR = "2024-10-07"
    initial_data_ingestion_flow(END_DATE_STR)
